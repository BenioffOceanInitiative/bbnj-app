---
title: "EXTRA from Solutions for 5 layer scenarios"
output:
  html_document:
    toc: true
    toc_depth: 4
    toc_float: true
    code_folding: hide
date: "`r Sys.Date()`"
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = F, message = F)
```

Cumulative sum plots of layers for determining target per layer and allowing weights to have differential impact on scenario solution.


## hex anti-meridian issues

TODO: investigate geometry repair over sf::`st_make_valid()` with `wdpar::st_repair_geometry()`, especially for dateline issues:

* [Clean data — wdpa_clean • wdpar](https://prioritizr.github.io/wdpar/reference/wdpa_clean.html)
* [Repair geometry — st_repair_geometry • wdpar](https://prioritizr.github.io/wdpar/reference/st_repair_geometry.html)

## plots of max feature


Generate all combinations of scenario parameters

```{r plots, results = 'asis'}
# after `pu_f <-`...

k_p <- sapply(
  c("fishing", "benthic", "scapes", "vgpm", "spp"),
  function(var){
    get_pu_v_ks(pu_f, !!sym(var), c(0.3, 0.5))
  }, 
  simplify = F)

p <- map(k_p, "p")

k <- map(k_p, "k") %>% 
  bind_rows() %>% 
  select(-km2) %>% 
  rename(pct_area = k)

datatable(k) %>% 
  formatPercentage(c("pct_area", "pct_val"), 1)
```

```{r plots, results = 'asis'}
# walk(p, print)
print(p)
print(p$fishing)
```

